bowtie2 -U case622_father.fq.gz -p 8 -x uni --rg-id 'SF' --rg "SM:father" | samtools view -Sb | samtools sort -o case622_father.bam

bowtie2 -U case622_child.fq -p 8 -x uni --rg-id 'SC' --rg "SM:child" | samtools view -Sb | samtools sort -o case622_child.bam


bowtie2 -U case622_mother.fq.gz -p 8 -x uni --rg-id 'SM' --rg "SM:mother" | samtools view -Sb | samtools sort -o case622_mother.bam

samtools index case622_mother.bam
samtools index case622_father.bam
samtools index case622_child.bam

qualimap bamqc -bam case622_child.bam
qualimap bamqc -bam case622_mother.bam
qualimap bamqc -bam case622_father.bam

multiqc ./

# generate coverage tracks with bedtools genomecov
# rembember to add tracklines and names
bedtools genomecov -ibam case622_father.bam -bg -trackline -trackopts 'name="father"' -max 100 > fatherCov.bg
bedtools genomecov -ibam case622_mother.bam -bg -trackline -trackopts 'name="mother"' -max 100 > motherCov.bg
bedtools genomecov -ibam case622_child.bam -bg -trackline -trackopts 'name="child"' -max 100 > childCov.bg

nohup freebayes -f universe.fasta -m 20 -C 5 -Q 10 --min-coverage 10 case622_child.bam case622_father.bam case622_mother.bam  > case622.vcf &

grep "^#CHR" case622.vcf

# select variants with the "right" segregation pattern
grep "#" case622.vcf > candilist622.vcf
grep "0/1.*0/1.*1/1" case622.vcf  >> candilist622.vcf

#keep only the variants included in the target regions
bedtools intersect -a candilist622.vcf -b exons16Padded_sorted.bed -u > 622candilistTG.vcf
